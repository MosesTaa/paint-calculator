<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Standard Paint Estimator</title>
  <script src="https://js.paystack.co/v1/inline.js"></script>
  <style>
    body {
      background: #121212;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
    }
    .container {
      width: 95%;
      max-width: 750px;
      padding: 20px;
      margin-top: 20px;
      background: #1e1e1e;
      border: 1px solid #333;
      border-radius: 10px;
    }
    h2, h3 {
      text-align: center;
    }
    input, select, button {
      width: 100%;
      padding: 12px;
      margin: 6px 0 12px 0;
      background: #2a2a2a;
      color: #fff;
      border: 1px solid #444;
      font-size: 16px;
      border-radius: 4px;
    }
    .hidden { display: none; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    table { width: 100%; margin-top: 10px; border-collapse: collapse; }
    th, td { border: 1px solid #555; padding: 8px; text-align: center; }
    ul { list-style: none; padding: 0; }
    ul li { display: flex; justify-content: space-between; background: #2a2a2a; padding: 6px 10px; border-radius: 5px; margin-bottom: 4px; }
    ul li button { background: #fff; color: #000; font-size: 12px; padding: 4px 6px; border: none; cursor: pointer; border-radius: 4px; }
  </style>
</head>
<body>
<div class="container">
  <!-- Page 1: Name, Email, Project Type -->
  <div id="page1">
    <h2>Paint Estimator</h2>
    <label for="name">Full Name</label>
    <input type="text" id="fullName" placeholder="Enter your name"><label for="email">Email Address</label>
<input type="email" id="email" placeholder="Enter your email">

<label>Project Type</label>
<select id="projectType">
  <option value="">Select type</option>
  <option value="new">New Construction</option>
  <option value="renovation">Renovation</option>
</select>

<div id="skimmingGroup" class="hidden">
  <label>Is Skimming Required?</label>
  <select id="skimming">
    <option value="yes">Yes</option>
    <option value="no">No</option>
  </select>
</div>

<button onclick="goToPage2()">Next</button>

  </div>  <!-- Page 2: Add Walls -->  <div id="page2" class="hidden">
    <h2>Add Walls</h2>
    <input type="text" id="wallName" placeholder="e.g. Kitchen Wall">
    <button onclick="addWall()">Add Wall</button>
    <ul id="wallList"></ul>
    <button onclick="goToPage3()">Next</button>
  </div>  <!-- Page 3: Wall Dimensions -->  <div id="page3" class="hidden">
    <h2>Enter Wall Dimensions</h2>
    <label>Unit</label>
    <select id="unit">
      <option value="meters">Meters</option>
      <option value="feet">Feet</option>
    </select>
    <div id="wallDimensionForm"></div>
    <button onclick="showPreview()">Next</button>
  </div>  <!-- Page 4: Preview -->  <div id="previewPage" class="hidden">
    <h2>Preview</h2>
    <table id="previewTable"><thead><tr><th>Wall</th><th>Length</th><th>Height</th><th>Doors</th><th>Windows</th></tr></thead><tbody></tbody></table>
    <button onclick="requestQuotation()">Request Quotation (KES 100)</button>
  </div>  <!-- Quotation -->  <div id="resultSection" class="hidden">
    <h2>Quotation</h2>
    <div id="result"></div>
    <button onclick="window.print()">Print</button>
  </div>
</div><script>
  let user = {}, walls = [], wallData = [], currentWall = 0;
  const FEET_TO_METERS = 0.3048;

  document.getElementById('projectType').addEventListener('change', e => {
    document.getElementById('skimmingGroup').classList.remove('hidden');
  });

  function goToPage2() {
    user.name = document.getElementById('fullName').value.trim();
    user.email = document.getElementById('email').value.trim();
    user.project = document.getElementById('projectType').value;
    user.skimming = document.getElementById('skimming').value;

    if (!user.name || !user.email || !user.project || !user.skimming) return alert("Complete all fields.");
    document.getElementById('page1').classList.add('hidden');
    document.getElementById('page2').classList.remove('hidden');
  }

  function addWall() {
    const name = document.getElementById('wallName').value.trim();
    if (!name || walls.includes(name)) return alert("Enter a unique wall name.");
    walls.push(name);
    wallData.push({ name });
    renderWalls();
    document.getElementById('wallName').value = "";
  }

  function renderWalls() {
    const list = document.getElementById('wallList');
    list.innerHTML = "";
    walls.forEach((w, i) => {
      list.innerHTML += `<li>${w} <button onclick="removeWall(${i})">Remove</button></li>`;
    });
  }

  function removeWall(i) {
    walls.splice(i, 1);
    wallData.splice(i, 1);
    renderWalls();
  }

  function goToPage3() {
    if (walls.length === 0) return alert("Add at least one wall.");
    document.getElementById('page2').classList.add('hidden');
    document.getElementById('page3').classList.remove('hidden');
    renderWallDimension();
  }

  function renderWallDimension() {
    const w = walls[currentWall];
    const u = document.getElementById('unit').value;
    const label = u === 'feet' ? 'ft' : 'm';
    document.getElementById('wallDimensionForm').innerHTML = `
      <h3>${w}</h3>
      <label>Length (${label})</label><input type="number" id="length">
      <label>Height (${label})</label><input type="number" id="height">
      <label>Doors</label><input type="number" id="doors" value="0">
      <label>Avg Door Width (${label})</label><input type="number" id="doorW">
      <label>Avg Door Height (${label})</label><input type="number" id="doorH">
      <label>Windows</label><input type="number" id="windows" value="0">
      <label>Avg Window Width (${label})</label><input type="number" id="winW">
      <label>Avg Window Height (${label})</label><input type="number" id="winH">
      <button onclick="saveWallDimension()">Save Wall Data</button>
    `;
  }

  function saveWallDimension() {
    const conv = document.getElementById('unit').value === 'feet' ? FEET_TO_METERS : 1;
    const l = parseFloat(document.getElementById('length').value) * conv;
    const h = parseFloat(document.getElementById('height').value) * conv;
    const d = parseInt(document.getElementById('doors').value);
    const dw = parseFloat(document.getElementById('doorW').value) * conv;
    const dh = parseFloat(document.getElementById('doorH').value) * conv;
    const w = parseInt(document.getElementById('windows').value);
    const ww = parseFloat(document.getElementById('winW').value) * conv;
    const wh = parseFloat(document.getElementById('winH').value) * conv;

    wallData[currentWall] = { ...wallData[currentWall], length: l, height: h, doors: d, doorW: dw, doorH: dh, windows: w, winW: ww, winH: wh };
    currentWall++;
    if (currentWall < walls.length) renderWallDimension();
    else {
      document.getElementById('page3').classList.add('hidden');
      document.getElementById('previewPage').classList.remove('hidden');
      showPreview();
    }
  }

  function showPreview() {
    const body = document.querySelector('#previewTable tbody');
    body.innerHTML = '';
    wallData.forEach(w => {
      body.innerHTML += `<tr><td>${w.name}</td><td>${w.length.toFixed(2)}</td><td>${w.height.toFixed(2)}</td><td>${w.doors}</td><td>${w.windows}</td></tr>`;
    });
  }

  function requestQuotation() {
    const handler = PaystackPop.setup({
      key: 'pk_test_4267eb88afba104984e24dd30e98880042131088',
      email: user.email,
      amount: 10000,
      currency: 'KES',
      callback: function(response) {
        document.getElementById('previewPage').classList.add('hidden');
        document.getElementById('resultSection').classList.remove('hidden');
        generateQuotation();
        alert('Payment successful: ' + response.reference);
      },
      onClose: function() { alert('Transaction cancelled'); }
    });
    handler.openIframe();
  }

  function generateQuotation() {
    let html = '<table><tr><th>Wall</th><th>Area (mÂ²)</th><th>Skim Coat</th><th>Undercoat</th><th>Topcoat</th></tr>';
    let total = { area: 0, skim: 0, under: 0, top: 0 };
    wallData.forEach(w => {
      const area = w.length * w.height - (w.doors * w.doorW * w.doorH + w.windows * w.winW * w.winH);
      const skim = user.skimming === 'yes' ? area / (user.project === 'new' ? 16 : 20) : 0;
      const under = area / 9;
      const top = (area * 2) / 9;
      total.area += area; total.skim += skim; total.under += under; total.top += top;
      html += `<tr><td>${w.name}</td><td>${area.toFixed(2)}</td><td>${skim.toFixed(2)} bags</td><td>${under.toFixed(2)}L</td><td>${top.toFixed(2)}L</td></tr>`;
    });
    html += `<tr><th>Total</th><th>${total.area.toFixed(2)}</th><th>${total.skim.toFixed(2)} bags</th><th>${total.under.toFixed(2)}L</th><th>${total.top.toFixed(2)}L</th></tr></table>`;
    document.getElementById('result').innerHTML = html;
  }
</script></body>
</html>
